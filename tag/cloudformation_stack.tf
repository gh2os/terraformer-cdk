resource "aws_cloudformation_stack" "tfer--cloudfront-waf-web-acl-stack" {
  capabilities     = ["CAPABILITY_AUTO_EXPAND", "CAPABILITY_IAM", "CAPABILITY_NAMED_IAM"]
  disable_rollback = "false"
  iam_role_arn     = "arn:aws:iam::760578178066:role/cdk-hnb659fds-cfn-exec-role-760578178066-us-east-1"
  name             = "cloudfront-waf-web-acl-stack"

  tags = {
    use = "terraformer"
  }

  tags_all = {
    use = "terraformer"
  }

  template_body      = "{\"Outputs\":{\"CLOUDFRONTWAFWEBACLARN\":{\"Value\":{\"Fn::GetAtt\":[\"cfwaf\",\"Arn\"]}}},\"Parameters\":{\"BootstrapVersion\":{\"Default\":\"/cdk-bootstrap/hnb659fds/version\",\"Description\":\"Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]\",\"Type\":\"AWS::SSM::Parameter::Value<String>\"}},\"Resources\":{\"CDKMetadata\":{\"Metadata\":{\"aws:cdk:path\":\"cloudfront-waf-web-acl-stack/CDKMetadata/Default\"},\"Properties\":{\"Analytics\":\"v2:deflate64:H4sIAAAAAAAA/z2JsQ7CIBQAv6U7PJGY6GpYTTR1cDSUPgytUMODMjT8uyEmTneXk3A6guh0IW7Gmb/dANs9aTMzXei5FW1XCcqGBw5ndWFEvv3owuumo/aYMDJlwz9qbXnN6ZNTsx5pydFgZWEZESbarVLA/gCim8g5HnNIziP0P34Bz62tAo8AAAA=\"},\"Type\":\"AWS::CDK::Metadata\"},\"cfwaf\":{\"Metadata\":{\"aws:cdk:path\":\"cloudfront-waf-web-acl-stack/cf-waf\"},\"Properties\":{\"DefaultAction\":{\"Allow\":{}},\"Description\":\"Web ACL for Moodle CloudFront\",\"Name\":\"moodle-cf-waf-acl\",\"Rules\":[{\"Name\":\"AWS-AWSManagedRulesAmazonIpReputationList\",\"OverrideAction\":{\"None\":{}},\"Priority\":0,\"Statement\":{\"ManagedRuleGroupStatement\":{\"ExcludedRules\":[],\"Name\":\"AWSManagedRulesAmazonIpReputationList\",\"VendorName\":\"AWS\"}},\"VisibilityConfig\":{\"CloudWatchMetricsEnabled\":true,\"MetricName\":\"AWS-AWSManagedRulesAmazonIpReputationList-metrics\",\"SampledRequestsEnabled\":true}}],\"Scope\":\"CLOUDFRONT\",\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VisibilityConfig\":{\"CloudWatchMetricsEnabled\":true,\"MetricName\":\"moodle-waf-metrics\",\"SampledRequestsEnabled\":true}},\"Type\":\"AWS::WAFv2::WebACL\"},\"cfwafwebaclarnssmparamD31AC3E9\":{\"Metadata\":{\"aws:cdk:path\":\"cloudfront-waf-web-acl-stack/cf-waf-web-acl-arn-ssm-param/Resource\"},\"Properties\":{\"Description\":\"The WAFv2 Web ACL used for CloudFront for Moodle\",\"Name\":\"cf-waf-web-acl-arn\",\"Tags\":{\"use\":\"terraformer\"},\"Type\":\"String\",\"Value\":{\"Fn::GetAtt\":[\"cfwaf\",\"Arn\"]}},\"Type\":\"AWS::SSM::Parameter\"}},\"Rules\":{\"CheckBootstrapVersion\":{\"Assertions\":[{\"Assert\":{\"Fn::Not\":[{\"Fn::Contains\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],{\"Ref\":\"BootstrapVersion\"}]}]},\"AssertDescription\":\"CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI.\"}]}}}"
  timeout_in_minutes = "0"
}

resource "aws_cloudformation_stack" "tfer--ecs-moodle-stack" {
  capabilities     = ["CAPABILITY_AUTO_EXPAND", "CAPABILITY_IAM", "CAPABILITY_NAMED_IAM"]
  disable_rollback = "false"
  iam_role_arn     = "arn:aws:iam::760578178066:role/cdk-hnb659fds-cfn-exec-role-760578178066-us-east-1"
  name             = "ecs-moodle-stack"

  tags = {
    use = "terraformer"
  }

  tags_all = {
    use = "terraformer"
  }

  template_body      = "{\"Conditions\":{\"CDKMetadataAvailable\":{\"Fn::Or\":[{\"Fn::Or\":[{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"af-south-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"ap-east-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"ap-northeast-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"ap-northeast-2\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"ap-south-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"ap-southeast-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"ap-southeast-2\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"ca-central-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"cn-north-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"cn-northwest-1\"]}]},{\"Fn::Or\":[{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"eu-central-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"eu-north-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"eu-south-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"eu-west-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"eu-west-2\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"eu-west-3\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"me-south-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"sa-east-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"us-east-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"us-east-2\"]}]},{\"Fn::Or\":[{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"us-west-1\"]},{\"Fn::Equals\":[{\"Ref\":\"AWS::Region\"},\"us-west-2\"]}]}]}},\"Outputs\":{\"APPLICATIONLOADBALANCERDNSNAME\":{\"Value\":{\"Fn::GetAtt\":[\"moodlealbE438512E\",\"DNSName\"]}},\"CLOUDFRONTDNSNAME\":{\"Value\":{\"Fn::GetAtt\":[\"moodleecsdistF1BF09A9\",\"DomainName\"]}},\"ECSCLUSTERNAME\":{\"Value\":{\"Ref\":\"ecscluster7830E7B5\"}},\"ECSVPCID\":{\"Value\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"MOODLECLOUDFRONTDISTID\":{\"Value\":{\"Ref\":\"moodleecsdistF1BF09A9\"}},\"MOODLEPASSWORDSECRETARN\":{\"Value\":{\"Ref\":\"moodlepasswordsecret585482A0\"}},\"MOODLEREDISPRIMARYENDPOINTADDRESSANDPORT\":{\"Value\":{\"Fn::Join\":[\"\",[{\"Fn::GetAtt\":[\"moodleredis\",\"PrimaryEndPoint.Address\"]},\":\",{\"Fn::GetAtt\":[\"moodleredis\",\"PrimaryEndPoint.Port\"]}]]}},\"MOODLESERVICENAME\":{\"Value\":{\"Fn::GetAtt\":[\"moodleserviceService319611B4\",\"Name\"]}},\"MOODLEUSERNAME\":{\"Value\":\"moodleadmin\"}},\"Parameters\":{\"BootstrapVersion\":{\"Default\":\"/cdk-bootstrap/hnb659fds/version\",\"Description\":\"Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]\",\"Type\":\"AWS::SSM::Parameter::Value<String>\"}},\"Resources\":{\"AWS679f53fac002430cb0da5b7982bd22872D164C4C\":{\"DependsOn\":[\"AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2\"],\"Metadata\":{\"aws:asset:is-bundled\":false,\"aws:asset:path\":\"asset.d62cd506a0f4ef6a29d7a97e2a02d80bc8248142ce428543cfbf0d84b3c116a2\",\"aws:asset:property\":\"Code\",\"aws:cdk:path\":\"ecs-moodle-stack/AWS679f53fac002430cb0da5b7982bd2287/Resource\"},\"Properties\":{\"Code\":{\"S3Bucket\":{\"Fn::Sub\":\"cdk-hnb659fds-assets-$${AWS::AccountId}-$${AWS::Region}\"},\"S3Key\":\"d62cd506a0f4ef6a29d7a97e2a02d80bc8248142ce428543cfbf0d84b3c116a2.zip\"},\"Handler\":\"index.handler\",\"Role\":{\"Fn::GetAtt\":[\"AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2\",\"Arn\"]},\"Runtime\":\"nodejs18.x\",\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"Timeout\":120},\"Type\":\"AWS::Lambda::Function\"},\"AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/Resource\"},\"Properties\":{\"AssumeRolePolicyDocument\":{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"},\"ManagedPolicyArns\":[{\"Fn::Join\":[\"\",[\"arn:\",{\"Ref\":\"AWS::Partition\"},\":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"]]}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::IAM::Role\"},\"CDKMetadata\":{\"Condition\":\"CDKMetadataAvailable\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/CDKMetadata/Default\"},\"Properties\":{\"Analytics\":\"v2:deflate64:H4sIAAAAAAAA/2VUTW/bMAz9LburWtcN2K75aIcC3RbEQa8FLTMeF0UyRCpBYPi/D7Ic22lPfHwiRYqP0IP+8V3ff4Iz35nqcGep1G0hYA4KzvzW8lfdLqM5oKjV3g0om423ZC4TPfjZWQJjp4z1sZIAZHW7SyZF96BTaB50+9qYRL1uVmoTS0umiKXLtSa09VFwB6XFiZ+4BbM3BELejcEJPD5vkvkN8hMEz3BRm0AnEJwufnaCweEYkDsZvIUImL9HdKKerD+/+DqdX2GfugeDr415dFXjyYkq0MRAcvkZfGz6Xt8Tr5vVGD3UmV/wPuXZ1QGZP/CPPd0pgqNutz4PpreTKBl1yvqadfvi67GJK04asG5XNrJgSCcf4QoaMCSXTfAnqjDMps3qCUINSQY+rHFPjq4ivGe8EyCHYcYNuQWGE5ks7AALAzYJmy5Z+eikU6Fi3a5BoATGZ8cCLgX2Qo7PWi/nxDW6QBOy2uvlmJnW44ROiliyCdSkjjrFfSgfwUGNQbd56ik7mx2EGmW2F2PAh5NMd4od63bnG+rXPIN50WGhZ03gnnX7RBaLCwse+5278X6lkeSCamEMMm+uuzNzO4UWWMiA+Yv5KbfT2mJjyfRCDssAzchAFM8GLLlat5Mefc101S2TzS6AOZCri5w3LeINMfZlPVQlWHCGXH160O1iKv/ioVr2Z3kXb/x5HLGgG2KueHaeGxufPHM7ZeFYVqDbglxtUbx7is7kzbyCNPoBd4q/vgEzCutFMvlr2wfvRLdrYglUxmvW3O86tUX2MRhUJrL441sYfNaLM696bgx57yahBtzXLQRqcv1X9CdKE3s9Vt5VlNt0vkL9jz+fHu71l2/6/tM/JroL0QkdUW+z/Q9e682s9AUAAA==\"},\"Type\":\"AWS::CDK::Metadata\"},\"cfwafwebaclarnssmparamreader5DB5C115\":{\"DeletionPolicy\":\"Delete\",\"DependsOn\":[\"cfwafwebaclarnssmparamreaderCustomResourcePolicy083D1F23\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/cf-waf-web-acl-arn-ssm-param-reader/Resource/Default\"},\"Properties\":{\"Create\":\"{\\\"service\\\":\\\"SSM\\\",\\\"action\\\":\\\"getParameter\\\",\\\"parameters\\\":{\\\"Name\\\":\\\"cf-waf-web-acl-arn\\\"},\\\"region\\\":\\\"us-east-1\\\",\\\"physicalResourceId\\\":{\\\"id\\\":\\\"1718049578256\\\"}}\",\"InstallLatestAwsSdk\":true,\"ServiceToken\":{\"Fn::GetAtt\":[\"AWS679f53fac002430cb0da5b7982bd22872D164C4C\",\"Arn\"]},\"Update\":\"{\\\"service\\\":\\\"SSM\\\",\\\"action\\\":\\\"getParameter\\\",\\\"parameters\\\":{\\\"Name\\\":\\\"cf-waf-web-acl-arn\\\"},\\\"region\\\":\\\"us-east-1\\\",\\\"physicalResourceId\\\":{\\\"id\\\":\\\"1718049578256\\\"}}\"},\"Type\":\"Custom::AWS\",\"UpdateReplacePolicy\":\"Delete\"},\"cfwafwebaclarnssmparamreaderCustomResourcePolicy083D1F23\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/cf-waf-web-acl-arn-ssm-param-reader/CustomResourcePolicy/Resource\"},\"Properties\":{\"PolicyDocument\":{\"Statement\":[{\"Action\":\"ssm:GetParameter\",\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"},\"PolicyName\":\"cfwafwebaclarnssmparamreaderCustomResourcePolicy083D1F23\",\"Roles\":[{\"Ref\":\"AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2\"}]},\"Type\":\"AWS::IAM::Policy\"},\"cloudtrailbucket4E585F26\":{\"DeletionPolicy\":\"Retain\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/cloudtrail-bucket/Resource\"},\"Properties\":{\"BucketEncryption\":{\"ServerSideEncryptionConfiguration\":[{\"ServerSideEncryptionByDefault\":{\"SSEAlgorithm\":\"AES256\"}}]},\"PublicAccessBlockConfiguration\":{\"BlockPublicAcls\":true,\"BlockPublicPolicy\":true,\"IgnorePublicAcls\":true,\"RestrictPublicBuckets\":true},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::S3::Bucket\",\"UpdateReplacePolicy\":\"Retain\"},\"cloudtrailbucketPolicy484D0FE7\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/cloudtrail-bucket/Policy/Resource\"},\"Properties\":{\"Bucket\":{\"Ref\":\"cloudtrailbucket4E585F26\"},\"PolicyDocument\":{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"Bool\":{\"aws:SecureTransport\":\"false\"}},\"Effect\":\"Deny\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":[{\"Fn::GetAtt\":[\"cloudtrailbucket4E585F26\",\"Arn\"]},{\"Fn::Join\":[\"\",[{\"Fn::GetAtt\":[\"cloudtrailbucket4E585F26\",\"Arn\"]},\"/*\"]]}]},{\"Action\":\"s3:GetBucketAcl\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":{\"Fn::GetAtt\":[\"cloudtrailbucket4E585F26\",\"Arn\"]}},{\"Action\":\"s3:PutObject\",\"Condition\":{\"StringEquals\":{\"s3:x-amz-acl\":\"bucket-owner-full-control\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":{\"Fn::Join\":[\"\",[{\"Fn::GetAtt\":[\"cloudtrailbucket4E585F26\",\"Arn\"]},\"/AWSLogs/\",{\"Ref\":\"AWS::AccountId\"},\"/*\"]]}}],\"Version\":\"2012-10-17\"}},\"Type\":\"AWS::S3::BucketPolicy\"},\"cloudtrailtrail59842059\":{\"DependsOn\":[\"cloudtrailbucketPolicy484D0FE7\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/cloudtrail-trail/Resource\"},\"Properties\":{\"EnableLogFileValidation\":true,\"EventSelectors\":[],\"IncludeGlobalServiceEvents\":true,\"IsLogging\":true,\"IsMultiRegionTrail\":true,\"S3BucketName\":{\"Ref\":\"cloudtrailbucket4E585F26\"},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::CloudTrail::Trail\"},\"ecscluster7830E7B5\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/ecs-cluster/Resource\"},\"Properties\":{\"ClusterName\":\"moodle-ecs-cluster\",\"ClusterSettings\":[{\"Name\":\"containerInsights\",\"Value\":\"enabled\"}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::ECS::Cluster\"},\"ecsclusterB48992C7\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/ecs-cluster/ecs-cluster\"},\"Properties\":{\"CapacityProviders\":[\"FARGATE\",\"FARGATE_SPOT\"],\"Cluster\":{\"Ref\":\"ecscluster7830E7B5\"},\"DefaultCapacityProviderStrategy\":[]},\"Type\":\"AWS::ECS::ClusterCapacityProviderAssociations\"},\"ecsmoodlestackmoodledbSecretDF9A532B38a0514b27838b1adcccf57602341508\":{\"DeletionPolicy\":\"Delete\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-db/Secret/Resource\"},\"Properties\":{\"Description\":{\"Fn::Join\":[\"\",[\"Generated by the CDK for stack: \",{\"Ref\":\"AWS::StackName\"}]]},\"GenerateSecretString\":{\"ExcludeCharacters\":\"(\\\" %+~`#$\\u0026*()|[]{}:;<>?!'/^-,@_=\\\\\",\"GenerateStringKey\":\"password\",\"PasswordLength\":30,\"SecretStringTemplate\":\"{\\\"username\\\":\\\"dbadmin\\\"}\"},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::SecretsManager::Secret\",\"UpdateReplacePolicy\":\"Delete\"},\"moodlealbE438512E\":{\"DependsOn\":[\"moodlevpcPublicSubnet1DefaultRoute19382C66\",\"moodlevpcPublicSubnet1RouteTableAssociation8A8F75AB\",\"moodlevpcPublicSubnet2DefaultRoute051774FE\",\"moodlevpcPublicSubnet2RouteTableAssociation85142B0A\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-alb/Resource\"},\"Properties\":{\"LoadBalancerAttributes\":[{\"Key\":\"deletion_protection.enabled\",\"Value\":\"false\"}],\"Name\":\"moodle-ecs-alb\",\"Scheme\":\"internet-facing\",\"SecurityGroups\":[{\"Fn::GetAtt\":[\"moodlealbSecurityGroup1390F35A\",\"GroupId\"]}],\"Subnets\":[{\"Ref\":\"moodlevpcPublicSubnet1SubnetCE2C1B1D\"},{\"Ref\":\"moodlevpcPublicSubnet2Subnet6F7768CB\"}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"Type\":\"application\"},\"Type\":\"AWS::ElasticLoadBalancingV2::LoadBalancer\"},\"moodlealbSecurityGroup1390F35A\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-alb/SecurityGroup/Resource\"},\"Properties\":{\"GroupDescription\":\"Automatically created Security Group for ELB ecsmoodlestackmoodlealbD39E5E3A\",\"SecurityGroupIngress\":[{\"CidrIp\":\"0.0.0.0/0\",\"Description\":\"Allow from anyone on port 80\",\"FromPort\":80,\"IpProtocol\":\"tcp\",\"ToPort\":80},{\"CidrIp\":\"0.0.0.0/0\",\"Description\":\"Allow from anyone on port 443\",\"FromPort\":443,\"IpProtocol\":\"tcp\",\"ToPort\":443}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::SecurityGroup\"},\"moodlealbSecurityGrouptoecsmoodlestackmoodleserviceSecurityGroup0F4C52F680809FA1F0FC\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-alb/SecurityGroup/to ecsmoodlestackmoodleserviceSecurityGroup0F4C52F6:8080\"},\"Properties\":{\"Description\":\"Load balancer to target\",\"DestinationSecurityGroupId\":{\"Fn::GetAtt\":[\"moodleserviceSecurityGroup1CC37159\",\"GroupId\"]},\"FromPort\":8080,\"GroupId\":{\"Fn::GetAtt\":[\"moodlealbSecurityGroup1390F35A\",\"GroupId\"]},\"IpProtocol\":\"tcp\",\"ToPort\":8080},\"Type\":\"AWS::EC2::SecurityGroupEgress\"},\"moodlealbhttplistener0E76609D\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-alb/http-listener/Resource\"},\"Properties\":{\"DefaultActions\":[{\"RedirectConfig\":{\"Port\":\"443\",\"Protocol\":\"HTTPS\",\"StatusCode\":\"HTTP_301\"},\"Type\":\"redirect\"}],\"LoadBalancerArn\":{\"Ref\":\"moodlealbE438512E\"},\"Port\":80,\"Protocol\":\"HTTP\"},\"Type\":\"AWS::ElasticLoadBalancingV2::Listener\"},\"moodlealbhttpslistenerE4F4DA58\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-alb/https-listener/Resource\"},\"Properties\":{\"Certificates\":[{\"CertificateArn\":\"arn:aws:acm:us-east-1:760578178066:certificate/49abdf3a-c07a-47f7-9722-ce1d149b9f5c\"}],\"DefaultActions\":[{\"TargetGroupArn\":{\"Ref\":\"moodlealbhttpslistenermoodleservicetgGroup52DC4313\"},\"Type\":\"forward\"}],\"LoadBalancerArn\":{\"Ref\":\"moodlealbE438512E\"},\"Port\":443,\"Protocol\":\"HTTPS\"},\"Type\":\"AWS::ElasticLoadBalancingV2::Listener\"},\"moodlealbhttpslistenermoodleservicetgGroup52DC4313\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-alb/https-listener/moodle-service-tgGroup/Resource\"},\"Properties\":{\"HealthCheckTimeoutSeconds\":20,\"Port\":8080,\"Protocol\":\"HTTP\",\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"TargetGroupAttributes\":[{\"Key\":\"stickiness.enabled\",\"Value\":\"false\"}],\"TargetType\":\"ip\",\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::ElasticLoadBalancingV2::TargetGroup\"},\"moodledbEAC964EB\":{\"DeletionPolicy\":\"Snapshot\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-db/Resource\"},\"Properties\":{\"AllocatedStorage\":\"30\",\"AutoMinorVersionUpgrade\":true,\"BackupRetentionPeriod\":7,\"CopyTagsToSnapshot\":true,\"DBInstanceClass\":\"db.t3.micro\",\"DBName\":\"moodledb\",\"DBSubnetGroupName\":{\"Ref\":\"moodledbSubnetGroup5287029B\"},\"EnablePerformanceInsights\":false,\"Engine\":\"mysql\",\"EngineVersion\":\"8.0.32\",\"MasterUserPassword\":{\"Fn::Join\":[\"\",[\"{{resolve:secretsmanager:\",{\"Ref\":\"ecsmoodlestackmoodledbSecretDF9A532B38a0514b27838b1adcccf57602341508\"},\":SecretString:password::}}\"]]},\"MasterUsername\":\"dbadmin\",\"MaxAllocatedStorage\":300,\"MultiAZ\":true,\"PubliclyAccessible\":false,\"StorageEncrypted\":true,\"StorageType\":\"gp2\",\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VPCSecurityGroups\":[{\"Fn::GetAtt\":[\"moodledbSecurityGroup0DFA55B1\",\"GroupId\"]}]},\"Type\":\"AWS::RDS::DBInstance\",\"UpdateReplacePolicy\":\"Snapshot\"},\"moodledbSecretAttachmentF9314C55\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-db/Secret/Attachment/Resource\"},\"Properties\":{\"SecretId\":{\"Ref\":\"ecsmoodlestackmoodledbSecretDF9A532B38a0514b27838b1adcccf57602341508\"},\"TargetId\":{\"Ref\":\"moodledbEAC964EB\"},\"TargetType\":\"AWS::RDS::DBInstance\"},\"Type\":\"AWS::SecretsManager::SecretTargetAttachment\"},\"moodledbSecurityGroup0DFA55B1\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-db/SecurityGroup/Resource\"},\"Properties\":{\"GroupDescription\":\"Security group for moodle-db database\",\"SecurityGroupEgress\":[{\"CidrIp\":\"0.0.0.0/0\",\"Description\":\"Allow all outbound traffic by default\",\"IpProtocol\":\"-1\"}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::SecurityGroup\"},\"moodledbSecurityGroupfromecsmoodlestackmoodleserviceSecurityGroup0F4C52F6IndirectPort288C40CD\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-db/SecurityGroup/from ecsmoodlestackmoodleserviceSecurityGroup0F4C52F6:{IndirectPort}\"},\"Properties\":{\"Description\":\"From Moodle ECS Service\",\"FromPort\":{\"Fn::GetAtt\":[\"moodledbEAC964EB\",\"Endpoint.Port\"]},\"GroupId\":{\"Fn::GetAtt\":[\"moodledbSecurityGroup0DFA55B1\",\"GroupId\"]},\"IpProtocol\":\"tcp\",\"SourceSecurityGroupId\":{\"Fn::GetAtt\":[\"moodleserviceSecurityGroup1CC37159\",\"GroupId\"]},\"ToPort\":{\"Fn::GetAtt\":[\"moodledbEAC964EB\",\"Endpoint.Port\"]}},\"Type\":\"AWS::EC2::SecurityGroupIngress\"},\"moodledbSubnetGroup5287029B\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-db/SubnetGroup/Default\"},\"Properties\":{\"DBSubnetGroupDescription\":\"Subnet group for moodle-db database\",\"SubnetIds\":[{\"Ref\":\"moodlevpcPrivateSubnet1SubnetEF479E8E\"},{\"Ref\":\"moodlevpcPrivateSubnet2Subnet9E0A2679\"}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::RDS::DBSubnetGroup\"},\"moodleecsdistF1BF09A9\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-ecs-dist/Resource\"},\"Properties\":{\"DistributionConfig\":{\"Aliases\":[\"devmoodle.eclaritylearning.ca\"],\"DefaultCacheBehavior\":{\"AllowedMethods\":[\"GET\",\"HEAD\",\"OPTIONS\",\"PUT\",\"PATCH\",\"POST\",\"DELETE\"],\"CachePolicyId\":\"4135ea2d-6df8-44a3-9df3-4b5a84be39ad\",\"Compress\":true,\"OriginRequestPolicyId\":\"216adef6-5c7f-47e4-b989-5492eafa07d3\",\"TargetOriginId\":\"ecsmoodlestackmoodleecsdistOrigin1C2737DD0\",\"ViewerProtocolPolicy\":\"redirect-to-https\"},\"Enabled\":true,\"HttpVersion\":\"http2\",\"IPV6Enabled\":true,\"Origins\":[{\"CustomOriginConfig\":{\"OriginProtocolPolicy\":\"https-only\",\"OriginReadTimeout\":60,\"OriginSSLProtocols\":[\"TLSv1.2\"]},\"DomainName\":{\"Fn::GetAtt\":[\"moodlealbE438512E\",\"DNSName\"]},\"Id\":\"ecsmoodlestackmoodleecsdistOrigin1C2737DD0\"}],\"ViewerCertificate\":{\"AcmCertificateArn\":\"arn:aws:acm:us-east-1:760578178066:certificate/4391e9c3-57ba-4346-a433-936c5e2f5233\",\"MinimumProtocolVersion\":\"TLSv1.2_2021\",\"SslSupportMethod\":\"sni-only\"},\"WebACLId\":{\"Fn::GetAtt\":[\"cfwafwebaclarnssmparamreader5DB5C115\",\"Parameter.Value\"]}},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::CloudFront::Distribution\"},\"moodleefs5D41A69F\":{\"DeletionPolicy\":\"Delete\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-efs/Resource\"},\"Properties\":{\"BackupPolicy\":{\"Status\":\"ENABLED\"},\"Encrypted\":true,\"FileSystemTags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-efs\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"LifecyclePolicies\":[{\"TransitionToIA\":\"AFTER_30_DAYS\"},{\"TransitionToPrimaryStorageClass\":\"AFTER_1_ACCESS\"}],\"PerformanceMode\":\"generalPurpose\",\"ThroughputMode\":\"elastic\"},\"Type\":\"AWS::EFS::FileSystem\",\"UpdateReplacePolicy\":\"Delete\"},\"moodleefsEfsMountTarget1357A6E82\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-efs/EfsMountTarget1\"},\"Properties\":{\"FileSystemId\":{\"Ref\":\"moodleefs5D41A69F\"},\"SecurityGroups\":[{\"Fn::GetAtt\":[\"moodleefsEfsSecurityGroup623A28C8\",\"GroupId\"]}],\"SubnetId\":{\"Ref\":\"moodlevpcPrivateSubnet1SubnetEF479E8E\"}},\"Type\":\"AWS::EFS::MountTarget\"},\"moodleefsEfsMountTarget27DA2EDDA\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-efs/EfsMountTarget2\"},\"Properties\":{\"FileSystemId\":{\"Ref\":\"moodleefs5D41A69F\"},\"SecurityGroups\":[{\"Fn::GetAtt\":[\"moodleefsEfsSecurityGroup623A28C8\",\"GroupId\"]}],\"SubnetId\":{\"Ref\":\"moodlevpcPrivateSubnet2Subnet9E0A2679\"}},\"Type\":\"AWS::EFS::MountTarget\"},\"moodleefsEfsSecurityGroup623A28C8\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-efs/EfsSecurityGroup/Resource\"},\"Properties\":{\"GroupDescription\":\"ecs-moodle-stack/moodle-efs/EfsSecurityGroup\",\"SecurityGroupEgress\":[{\"CidrIp\":\"0.0.0.0/0\",\"Description\":\"Allow all outbound traffic by default\",\"IpProtocol\":\"-1\"}],\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-efs\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::SecurityGroup\"},\"moodleefsEfsSecurityGroupfromecsmoodlestackmoodleserviceSecurityGroup0F4C52F620496D755305\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-efs/EfsSecurityGroup/from ecsmoodlestackmoodleserviceSecurityGroup0F4C52F6:2049\"},\"Properties\":{\"Description\":\"From Moodle ECS Service\",\"FromPort\":2049,\"GroupId\":{\"Fn::GetAtt\":[\"moodleefsEfsSecurityGroup623A28C8\",\"GroupId\"]},\"IpProtocol\":\"tcp\",\"SourceSecurityGroupId\":{\"Fn::GetAtt\":[\"moodleserviceSecurityGroup1CC37159\",\"GroupId\"]},\"ToPort\":2049},\"Type\":\"AWS::EC2::SecurityGroupIngress\"},\"moodleefsmoodleefsaccesspoint838A8304\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-efs/moodle-efs-access-point/Resource\"},\"Properties\":{\"AccessPointTags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-efs/moodle-efs-access-point\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"FileSystemId\":{\"Ref\":\"moodleefs5D41A69F\"},\"RootDirectory\":{\"Path\":\"/\"}},\"Type\":\"AWS::EFS::AccessPoint\"},\"moodlepasswordsecret585482A0\":{\"DeletionPolicy\":\"Delete\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-password-secret/Resource\"},\"Properties\":{\"GenerateSecretString\":{},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::SecretsManager::Secret\",\"UpdateReplacePolicy\":\"Delete\"},\"moodleredis\":{\"DependsOn\":[\"redissubnetgroup\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-redis\"},\"Properties\":{\"AtRestEncryptionEnabled\":true,\"AutoMinorVersionUpgrade\":true,\"AutomaticFailoverEnabled\":true,\"CacheNodeType\":\"cache.t4g.micro\",\"CacheSubnetGroupName\":\"ecsmoodlestack-redis-subnet-group\",\"Engine\":\"redis\",\"MultiAZEnabled\":true,\"NumCacheClusters\":2,\"ReplicationGroupDescription\":\"Moodle Redis\",\"SecurityGroupIds\":[{\"Fn::GetAtt\":[\"moodleredissgEE874356\",\"GroupId\"]}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::ElastiCache::ReplicationGroup\"},\"moodleredissgEE874356\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-redis-sg/Resource\"},\"Properties\":{\"GroupDescription\":\"ecs-moodle-stack/moodle-redis-sg\",\"SecurityGroupEgress\":[{\"CidrIp\":\"0.0.0.0/0\",\"Description\":\"Allow all outbound traffic by default\",\"IpProtocol\":\"-1\"}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::SecurityGroup\"},\"moodleredissgfromecsmoodlestackmoodleserviceSecurityGroup0F4C52F663792A177E77\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-redis-sg/from ecsmoodlestackmoodleserviceSecurityGroup0F4C52F6:6379\"},\"Properties\":{\"Description\":\"From Moodle ECS Service\",\"FromPort\":6379,\"GroupId\":{\"Fn::GetAtt\":[\"moodleredissgEE874356\",\"GroupId\"]},\"IpProtocol\":\"tcp\",\"SourceSecurityGroupId\":{\"Fn::GetAtt\":[\"moodleserviceSecurityGroup1CC37159\",\"GroupId\"]},\"ToPort\":6379},\"Type\":\"AWS::EC2::SecurityGroupIngress\"},\"moodleserviceSecurityGroup1CC37159\":{\"DependsOn\":[\"moodletaskdefTaskRoleD0BAB4BB\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-service/SecurityGroup/Resource\"},\"Properties\":{\"GroupDescription\":\"ecs-moodle-stack/moodle-service/SecurityGroup\",\"SecurityGroupEgress\":[{\"CidrIp\":\"0.0.0.0/0\",\"Description\":\"Allow all outbound traffic by default\",\"IpProtocol\":\"-1\"}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::SecurityGroup\"},\"moodleserviceSecurityGroupfromecsmoodlestackmoodlealbSecurityGroupD1B054938080F4A4D01E\":{\"DependsOn\":[\"moodletaskdefTaskRoleD0BAB4BB\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-service/SecurityGroup/from ecsmoodlestackmoodlealbSecurityGroupD1B05493:8080\"},\"Properties\":{\"Description\":\"Load balancer to target\",\"FromPort\":8080,\"GroupId\":{\"Fn::GetAtt\":[\"moodleserviceSecurityGroup1CC37159\",\"GroupId\"]},\"IpProtocol\":\"tcp\",\"SourceSecurityGroupId\":{\"Fn::GetAtt\":[\"moodlealbSecurityGroup1390F35A\",\"GroupId\"]},\"ToPort\":8080},\"Type\":\"AWS::EC2::SecurityGroupIngress\"},\"moodleserviceService319611B4\":{\"DependsOn\":[\"moodlealbhttpslistenermoodleservicetgGroup52DC4313\",\"moodlealbhttpslistenerE4F4DA58\",\"moodletaskdefTaskRoleD0BAB4BB\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-service/Service\"},\"Properties\":{\"CapacityProviderStrategy\":[{\"CapacityProvider\":\"FARGATE_SPOT\",\"Weight\":3},{\"CapacityProvider\":\"FARGATE\",\"Weight\":1}],\"Cluster\":{\"Ref\":\"ecscluster7830E7B5\"},\"DeploymentConfiguration\":{\"Alarms\":{\"AlarmNames\":[],\"Enable\":false,\"Rollback\":false},\"DeploymentCircuitBreaker\":{\"Enable\":true,\"Rollback\":true},\"MaximumPercent\":200,\"MinimumHealthyPercent\":50},\"DeploymentController\":{\"Type\":\"ECS\"},\"DesiredCount\":1,\"EnableECSManagedTags\":true,\"HealthCheckGracePeriodSeconds\":1800,\"LoadBalancers\":[{\"ContainerName\":\"moodle\",\"ContainerPort\":8080,\"TargetGroupArn\":{\"Ref\":\"moodlealbhttpslistenermoodleservicetgGroup52DC4313\"}}],\"NetworkConfiguration\":{\"AwsvpcConfiguration\":{\"AssignPublicIp\":\"DISABLED\",\"SecurityGroups\":[{\"Fn::GetAtt\":[\"moodleserviceSecurityGroup1CC37159\",\"GroupId\"]}],\"Subnets\":[{\"Ref\":\"moodlevpcPrivateSubnet1SubnetEF479E8E\"},{\"Ref\":\"moodlevpcPrivateSubnet2Subnet9E0A2679\"}]}},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"TaskDefinition\":{\"Ref\":\"moodletaskdefCA53AB93\"}},\"Type\":\"AWS::ECS::Service\"},\"moodleserviceTaskCountTarget51B92049\":{\"DependsOn\":[\"moodletaskdefTaskRoleD0BAB4BB\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-service/TaskCount/Target/Resource\"},\"Properties\":{\"MaxCapacity\":10,\"MinCapacity\":1,\"ResourceId\":{\"Fn::Join\":[\"\",[\"service/\",{\"Ref\":\"ecscluster7830E7B5\"},\"/\",{\"Fn::GetAtt\":[\"moodleserviceService319611B4\",\"Name\"]}]]},\"RoleARN\":{\"Fn::Join\":[\"\",[\"arn:\",{\"Ref\":\"AWS::Partition\"},\":iam::\",{\"Ref\":\"AWS::AccountId\"},\":role/aws-service-role/ecs.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_ECSService\"]]},\"ScalableDimension\":\"ecs:service:DesiredCount\",\"ServiceNamespace\":\"ecs\"},\"Type\":\"AWS::ApplicationAutoScaling::ScalableTarget\"},\"moodleserviceTaskCountTargetcpuscaling0E544F71\":{\"DependsOn\":[\"moodletaskdefTaskRoleD0BAB4BB\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-service/TaskCount/Target/cpu-scaling/Resource\"},\"Properties\":{\"PolicyName\":\"ecsmoodlestackmoodleserviceTaskCountTargetcpuscaling44B2A72D\",\"PolicyType\":\"TargetTrackingScaling\",\"ScalingTargetId\":{\"Ref\":\"moodleserviceTaskCountTarget51B92049\"},\"TargetTrackingScalingPolicyConfiguration\":{\"PredefinedMetricSpecification\":{\"PredefinedMetricType\":\"ECSServiceAverageCPUUtilization\"},\"TargetValue\":50}},\"Type\":\"AWS::ApplicationAutoScaling::ScalingPolicy\"},\"moodletaskdefCA53AB93\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-task-def/Resource\"},\"Properties\":{\"ContainerDefinitions\":[{\"Environment\":[{\"Name\":\"MOODLE_DATABASE_TYPE\",\"Value\":\"mysqli\"},{\"Name\":\"MOODLE_DATABASE_HOST\",\"Value\":{\"Fn::GetAtt\":[\"moodledbEAC964EB\",\"Endpoint.Address\"]}},{\"Name\":\"MOODLE_DATABASE_PORT_NUMBER\",\"Value\":{\"Fn::GetAtt\":[\"moodledbEAC964EB\",\"Endpoint.Port\"]}},{\"Name\":\"MOODLE_DATABASE_NAME\",\"Value\":\"moodledb\"},{\"Name\":\"MOODLE_DATABASE_USER\",\"Value\":\"dbadmin\"},{\"Name\":\"MOODLE_USERNAME\",\"Value\":\"moodleadmin\"},{\"Name\":\"MOODLE_EMAIL\",\"Value\":\"hello@example.com\"},{\"Name\":\"MOODLE_SITE_NAME\",\"Value\":\"Scalable Moodle on ECS Fargate\"},{\"Name\":\"MOODLE_SKIP_BOOTSTRAP\",\"Value\":\"no\"},{\"Name\":\"MOODLE_SKIP_INSTALL\",\"Value\":\"no\"},{\"Name\":\"BITNAMI_DEBUG\",\"Value\":\"true\"}],\"Essential\":true,\"Image\":\"760578178066.dkr.ecr.us-east-1.amazonaws.com/cdk-moodle-image:latest\",\"LogConfiguration\":{\"LogDriver\":\"awslogs\",\"Options\":{\"awslogs-group\":{\"Ref\":\"moodletaskdefmoodlecontainerLogGroup581119A2\"},\"awslogs-region\":{\"Ref\":\"AWS::Region\"},\"awslogs-stream-prefix\":\"ecs-moodle\"}},\"Memory\":4096,\"MountPoints\":[{\"ContainerPath\":\"/bitnami\",\"ReadOnly\":false,\"SourceVolume\":\"moodle\"}],\"Name\":\"moodle\",\"PortMappings\":[{\"ContainerPort\":8080,\"Protocol\":\"tcp\"}],\"Secrets\":[{\"Name\":\"MOODLE_DATABASE_PASSWORD\",\"ValueFrom\":{\"Fn::Join\":[\"\",[{\"Ref\":\"moodledbSecretAttachmentF9314C55\"},\":password::\"]]}},{\"Name\":\"MOODLE_PASSWORD\",\"ValueFrom\":{\"Ref\":\"moodlepasswordsecret585482A0\"}}],\"StopTimeout\":120}],\"Cpu\":\"2048\",\"ExecutionRoleArn\":{\"Fn::GetAtt\":[\"moodletaskdefExecutionRole4692C07D\",\"Arn\"]},\"Family\":\"ecsmoodlestackmoodletaskdef3B550A0F\",\"Memory\":\"4096\",\"NetworkMode\":\"awsvpc\",\"RequiresCompatibilities\":[\"FARGATE\"],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"TaskRoleArn\":{\"Fn::GetAtt\":[\"moodletaskdefTaskRoleD0BAB4BB\",\"Arn\"]},\"Volumes\":[{\"EFSVolumeConfiguration\":{\"AuthorizationConfig\":{\"AccessPointId\":{\"Ref\":\"moodleefsmoodleefsaccesspoint838A8304\"}},\"FilesystemId\":{\"Ref\":\"moodleefs5D41A69F\"},\"TransitEncryption\":\"ENABLED\"},\"Name\":\"moodle\"}]},\"Type\":\"AWS::ECS::TaskDefinition\"},\"moodletaskdefExecutionRole4692C07D\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-task-def/ExecutionRole/Resource\"},\"Properties\":{\"AssumeRolePolicyDocument\":{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::IAM::Role\"},\"moodletaskdefExecutionRoleDefaultPolicy6167E6A2\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-task-def/ExecutionRole/DefaultPolicy/Resource\"},\"Properties\":{\"PolicyDocument\":{\"Statement\":[{\"Action\":[\"ecr:GetAuthorizationToken\",\"ecr:BatchCheckLayerAvailability\",\"ecr:GetDownloadUrlForLayer\",\"ecr:BatchGetImage\",\"logs:CreateLogStream\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"logs:CreateLogStream\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":{\"Fn::GetAtt\":[\"moodletaskdefmoodlecontainerLogGroup581119A2\",\"Arn\"]}},{\"Action\":[\"secretsmanager:GetSecretValue\",\"secretsmanager:DescribeSecret\"],\"Effect\":\"Allow\",\"Resource\":{\"Ref\":\"moodledbSecretAttachmentF9314C55\"}},{\"Action\":[\"secretsmanager:GetSecretValue\",\"secretsmanager:DescribeSecret\"],\"Effect\":\"Allow\",\"Resource\":{\"Ref\":\"moodlepasswordsecret585482A0\"}}],\"Version\":\"2012-10-17\"},\"PolicyName\":\"moodletaskdefExecutionRoleDefaultPolicy6167E6A2\",\"Roles\":[{\"Ref\":\"moodletaskdefExecutionRole4692C07D\"}]},\"Type\":\"AWS::IAM::Policy\"},\"moodletaskdefTaskRoleD0BAB4BB\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-task-def/TaskRole/Resource\"},\"Properties\":{\"AssumeRolePolicyDocument\":{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ecs-tasks.amazonaws.com\"}}],\"Version\":\"2012-10-17\"},\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::IAM::Role\"},\"moodletaskdefmoodlecontainerLogGroup581119A2\":{\"DeletionPolicy\":\"Retain\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-task-def/moodle-container/LogGroup/Resource\"},\"Properties\":{\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::Logs::LogGroup\",\"UpdateReplacePolicy\":\"Retain\"},\"moodlevpcBC9D4C73\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/Resource\"},\"Properties\":{\"CidrBlock\":\"10.0.0.0/16\",\"EnableDnsHostnames\":true,\"EnableDnsSupport\":true,\"InstanceTenancy\":\"default\",\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::EC2::VPC\"},\"moodlevpcIGW63131C77\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/IGW\"},\"Properties\":{\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::EC2::InternetGateway\"},\"moodlevpcPrivateSubnet1DefaultRouteC10F66ED\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet1/DefaultRoute\"},\"Properties\":{\"DestinationCidrBlock\":\"0.0.0.0/0\",\"NatGatewayId\":{\"Ref\":\"moodlevpcPublicSubnet1NATGatewayFD3ECE69\"},\"RouteTableId\":{\"Ref\":\"moodlevpcPrivateSubnet1RouteTableE7BD8FD7\"}},\"Type\":\"AWS::EC2::Route\"},\"moodlevpcPrivateSubnet1RouteTableAssociationA7848358\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet1/RouteTableAssociation\"},\"Properties\":{\"RouteTableId\":{\"Ref\":\"moodlevpcPrivateSubnet1RouteTableE7BD8FD7\"},\"SubnetId\":{\"Ref\":\"moodlevpcPrivateSubnet1SubnetEF479E8E\"}},\"Type\":\"AWS::EC2::SubnetRouteTableAssociation\"},\"moodlevpcPrivateSubnet1RouteTableE7BD8FD7\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet1/RouteTable\"},\"Properties\":{\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet1\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::RouteTable\"},\"moodlevpcPrivateSubnet1SubnetEF479E8E\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet1/Subnet\"},\"Properties\":{\"AvailabilityZone\":{\"Fn::Select\":[0,{\"Fn::GetAZs\":\"\"}]},\"CidrBlock\":\"10.0.128.0/18\",\"MapPublicIpOnLaunch\":false,\"Tags\":[{\"Key\":\"aws-cdk:subnet-name\",\"Value\":\"Private\"},{\"Key\":\"aws-cdk:subnet-type\",\"Value\":\"Private\"},{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet1\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::Subnet\"},\"moodlevpcPrivateSubnet2DefaultRoute397D30FC\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet2/DefaultRoute\"},\"Properties\":{\"DestinationCidrBlock\":\"0.0.0.0/0\",\"NatGatewayId\":{\"Ref\":\"moodlevpcPublicSubnet2NATGateway9CA8DD59\"},\"RouteTableId\":{\"Ref\":\"moodlevpcPrivateSubnet2RouteTableE8F2B71E\"}},\"Type\":\"AWS::EC2::Route\"},\"moodlevpcPrivateSubnet2RouteTableAssociation0D77E104\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet2/RouteTableAssociation\"},\"Properties\":{\"RouteTableId\":{\"Ref\":\"moodlevpcPrivateSubnet2RouteTableE8F2B71E\"},\"SubnetId\":{\"Ref\":\"moodlevpcPrivateSubnet2Subnet9E0A2679\"}},\"Type\":\"AWS::EC2::SubnetRouteTableAssociation\"},\"moodlevpcPrivateSubnet2RouteTableE8F2B71E\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet2/RouteTable\"},\"Properties\":{\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet2\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::RouteTable\"},\"moodlevpcPrivateSubnet2Subnet9E0A2679\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet2/Subnet\"},\"Properties\":{\"AvailabilityZone\":{\"Fn::Select\":[1,{\"Fn::GetAZs\":\"\"}]},\"CidrBlock\":\"10.0.192.0/18\",\"MapPublicIpOnLaunch\":false,\"Tags\":[{\"Key\":\"aws-cdk:subnet-name\",\"Value\":\"Private\"},{\"Key\":\"aws-cdk:subnet-type\",\"Value\":\"Private\"},{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PrivateSubnet2\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::Subnet\"},\"moodlevpcPublicSubnet1DefaultRoute19382C66\":{\"DependsOn\":[\"moodlevpcVPCGW70A0E41B\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1/DefaultRoute\"},\"Properties\":{\"DestinationCidrBlock\":\"0.0.0.0/0\",\"GatewayId\":{\"Ref\":\"moodlevpcIGW63131C77\"},\"RouteTableId\":{\"Ref\":\"moodlevpcPublicSubnet1RouteTableC5B1D43E\"}},\"Type\":\"AWS::EC2::Route\"},\"moodlevpcPublicSubnet1EIP526D377A\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1/EIP\"},\"Properties\":{\"Domain\":\"vpc\",\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::EC2::EIP\"},\"moodlevpcPublicSubnet1NATGatewayFD3ECE69\":{\"DependsOn\":[\"moodlevpcPublicSubnet1DefaultRoute19382C66\",\"moodlevpcPublicSubnet1RouteTableAssociation8A8F75AB\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1/NATGateway\"},\"Properties\":{\"AllocationId\":{\"Fn::GetAtt\":[\"moodlevpcPublicSubnet1EIP526D377A\",\"AllocationId\"]},\"SubnetId\":{\"Ref\":\"moodlevpcPublicSubnet1SubnetCE2C1B1D\"},\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::EC2::NatGateway\"},\"moodlevpcPublicSubnet1RouteTableAssociation8A8F75AB\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1/RouteTableAssociation\"},\"Properties\":{\"RouteTableId\":{\"Ref\":\"moodlevpcPublicSubnet1RouteTableC5B1D43E\"},\"SubnetId\":{\"Ref\":\"moodlevpcPublicSubnet1SubnetCE2C1B1D\"}},\"Type\":\"AWS::EC2::SubnetRouteTableAssociation\"},\"moodlevpcPublicSubnet1RouteTableC5B1D43E\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1/RouteTable\"},\"Properties\":{\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::RouteTable\"},\"moodlevpcPublicSubnet1SubnetCE2C1B1D\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1/Subnet\"},\"Properties\":{\"AvailabilityZone\":{\"Fn::Select\":[0,{\"Fn::GetAZs\":\"\"}]},\"CidrBlock\":\"10.0.0.0/18\",\"MapPublicIpOnLaunch\":true,\"Tags\":[{\"Key\":\"aws-cdk:subnet-name\",\"Value\":\"Public\"},{\"Key\":\"aws-cdk:subnet-type\",\"Value\":\"Public\"},{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet1\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::Subnet\"},\"moodlevpcPublicSubnet2DefaultRoute051774FE\":{\"DependsOn\":[\"moodlevpcVPCGW70A0E41B\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2/DefaultRoute\"},\"Properties\":{\"DestinationCidrBlock\":\"0.0.0.0/0\",\"GatewayId\":{\"Ref\":\"moodlevpcIGW63131C77\"},\"RouteTableId\":{\"Ref\":\"moodlevpcPublicSubnet2RouteTable522FAD12\"}},\"Type\":\"AWS::EC2::Route\"},\"moodlevpcPublicSubnet2EIPAC5EC96A\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2/EIP\"},\"Properties\":{\"Domain\":\"vpc\",\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::EC2::EIP\"},\"moodlevpcPublicSubnet2NATGateway9CA8DD59\":{\"DependsOn\":[\"moodlevpcPublicSubnet2DefaultRoute051774FE\",\"moodlevpcPublicSubnet2RouteTableAssociation85142B0A\"],\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2/NATGateway\"},\"Properties\":{\"AllocationId\":{\"Fn::GetAtt\":[\"moodlevpcPublicSubnet2EIPAC5EC96A\",\"AllocationId\"]},\"SubnetId\":{\"Ref\":\"moodlevpcPublicSubnet2Subnet6F7768CB\"},\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::EC2::NatGateway\"},\"moodlevpcPublicSubnet2RouteTable522FAD12\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2/RouteTable\"},\"Properties\":{\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::RouteTable\"},\"moodlevpcPublicSubnet2RouteTableAssociation85142B0A\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2/RouteTableAssociation\"},\"Properties\":{\"RouteTableId\":{\"Ref\":\"moodlevpcPublicSubnet2RouteTable522FAD12\"},\"SubnetId\":{\"Ref\":\"moodlevpcPublicSubnet2Subnet6F7768CB\"}},\"Type\":\"AWS::EC2::SubnetRouteTableAssociation\"},\"moodlevpcPublicSubnet2Subnet6F7768CB\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2/Subnet\"},\"Properties\":{\"AvailabilityZone\":{\"Fn::Select\":[1,{\"Fn::GetAZs\":\"\"}]},\"CidrBlock\":\"10.0.64.0/18\",\"MapPublicIpOnLaunch\":true,\"Tags\":[{\"Key\":\"aws-cdk:subnet-name\",\"Value\":\"Public\"},{\"Key\":\"aws-cdk:subnet-type\",\"Value\":\"Public\"},{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc/PublicSubnet2\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::Subnet\"},\"moodlevpcVPCGW70A0E41B\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/VPCGW\"},\"Properties\":{\"InternetGatewayId\":{\"Ref\":\"moodlevpcIGW63131C77\"},\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::VPCGatewayAttachment\"},\"moodlevpcecrvpcendpoint6B3F6EEB\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/ecr-vpc-endpoint/Resource\"},\"Properties\":{\"PrivateDnsEnabled\":true,\"SecurityGroupIds\":[{\"Fn::GetAtt\":[\"moodlevpcecrvpcendpointSecurityGroup70984AF4\",\"GroupId\"]}],\"ServiceName\":{\"Fn::Join\":[\"\",[\"com.amazonaws.\",{\"Ref\":\"AWS::Region\"},\".ecr.api\"]]},\"SubnetIds\":[{\"Ref\":\"moodlevpcPrivateSubnet1SubnetEF479E8E\"},{\"Ref\":\"moodlevpcPrivateSubnet2Subnet9E0A2679\"}],\"VpcEndpointType\":\"Interface\",\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::VPCEndpoint\"},\"moodlevpcecrvpcendpointSecurityGroup70984AF4\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/ecr-vpc-endpoint/SecurityGroup/Resource\"},\"Properties\":{\"GroupDescription\":\"ecs-moodle-stack/moodle-vpc/ecr-vpc-endpoint/SecurityGroup\",\"SecurityGroupEgress\":[{\"CidrIp\":\"0.0.0.0/0\",\"Description\":\"Allow all outbound traffic by default\",\"IpProtocol\":\"-1\"}],\"SecurityGroupIngress\":[{\"CidrIp\":{\"Fn::GetAtt\":[\"moodlevpcBC9D4C73\",\"CidrBlock\"]},\"Description\":{\"Fn::Join\":[\"\",[\"from \",{\"Fn::GetAtt\":[\"moodlevpcBC9D4C73\",\"CidrBlock\"]},\":443\"]]},\"FromPort\":443,\"IpProtocol\":\"tcp\",\"ToPort\":443}],\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::SecurityGroup\"},\"moodlevpcflowlogtocloudwatchFlowLogCF7FFF52\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/flowlog-to-cloudwatch/FlowLog\"},\"Properties\":{\"DeliverLogsPermissionArn\":{\"Fn::GetAtt\":[\"moodlevpcflowlogtocloudwatchIAMRole9F81A053\",\"Arn\"]},\"LogDestinationType\":\"cloud-watch-logs\",\"LogGroupName\":{\"Ref\":\"moodlevpcflowlogtocloudwatchLogGroup436624C1\"},\"ResourceId\":{\"Ref\":\"moodlevpcBC9D4C73\"},\"ResourceType\":\"VPC\",\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}],\"TrafficType\":\"ALL\"},\"Type\":\"AWS::EC2::FlowLog\"},\"moodlevpcflowlogtocloudwatchIAMRole9F81A053\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/flowlog-to-cloudwatch/IAMRole/Resource\"},\"Properties\":{\"AssumeRolePolicyDocument\":{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"vpc-flow-logs.amazonaws.com\"}}],\"Version\":\"2012-10-17\"},\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::IAM::Role\"},\"moodlevpcflowlogtocloudwatchIAMRoleDefaultPolicy8B9F4BE3\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/flowlog-to-cloudwatch/IAMRole/DefaultPolicy/Resource\"},\"Properties\":{\"PolicyDocument\":{\"Statement\":[{\"Action\":[\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"logs:DescribeLogStreams\"],\"Effect\":\"Allow\",\"Resource\":{\"Fn::GetAtt\":[\"moodlevpcflowlogtocloudwatchLogGroup436624C1\",\"Arn\"]}},{\"Action\":\"iam:PassRole\",\"Effect\":\"Allow\",\"Resource\":{\"Fn::GetAtt\":[\"moodlevpcflowlogtocloudwatchIAMRole9F81A053\",\"Arn\"]}}],\"Version\":\"2012-10-17\"},\"PolicyName\":\"moodlevpcflowlogtocloudwatchIAMRoleDefaultPolicy8B9F4BE3\",\"Roles\":[{\"Ref\":\"moodlevpcflowlogtocloudwatchIAMRole9F81A053\"}]},\"Type\":\"AWS::IAM::Policy\"},\"moodlevpcflowlogtocloudwatchLogGroup436624C1\":{\"DeletionPolicy\":\"Retain\",\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/flowlog-to-cloudwatch/LogGroup/Resource\"},\"Properties\":{\"RetentionInDays\":731,\"Tags\":[{\"Key\":\"Name\",\"Value\":\"ecs-moodle-stack/moodle-vpc\"},{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::Logs::LogGroup\",\"UpdateReplacePolicy\":\"Retain\"},\"moodlevpcs3vpcendpointC32B0DBA\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/moodle-vpc/s3-vpc-endpoint/Resource\"},\"Properties\":{\"RouteTableIds\":[{\"Ref\":\"moodlevpcPrivateSubnet1RouteTableE7BD8FD7\"},{\"Ref\":\"moodlevpcPrivateSubnet2RouteTableE8F2B71E\"},{\"Ref\":\"moodlevpcPublicSubnet1RouteTableC5B1D43E\"},{\"Ref\":\"moodlevpcPublicSubnet2RouteTable522FAD12\"}],\"ServiceName\":{\"Fn::Join\":[\"\",[\"com.amazonaws.\",{\"Ref\":\"AWS::Region\"},\".s3\"]]},\"VpcEndpointType\":\"Gateway\",\"VpcId\":{\"Ref\":\"moodlevpcBC9D4C73\"}},\"Type\":\"AWS::EC2::VPCEndpoint\"},\"rdseventsubscription\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/rds-event-subscription\"},\"Properties\":{\"Enabled\":true,\"EventCategories\":[\"availability\",\"configuration change\",\"failure\",\"maintenance\",\"low storage\"],\"SnsTopicArn\":{\"Ref\":\"rdseventsubscriptiontopicFF8A7653\"},\"SourceType\":\"db-instance\",\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::RDS::EventSubscription\"},\"rdseventsubscriptiontopicFF8A7653\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/rds-event-subscription-topic/Resource\"},\"Properties\":{\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::SNS::Topic\"},\"rdseventsubscriptiontopicuserexamplecomCF3BE667\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/rds-event-subscription-topic/user@example.com/Resource\"},\"Properties\":{\"Endpoint\":\"user@example.com\",\"Protocol\":\"email\",\"TopicArn\":{\"Ref\":\"rdseventsubscriptiontopicFF8A7653\"}},\"Type\":\"AWS::SNS::Subscription\"},\"redissubnetgroup\":{\"Metadata\":{\"aws:cdk:path\":\"ecs-moodle-stack/redis-subnet-group\"},\"Properties\":{\"CacheSubnetGroupName\":\"ecsmoodlestack-redis-subnet-group\",\"Description\":\"Moodle Redis Subnet Group\",\"SubnetIds\":[{\"Ref\":\"moodlevpcPrivateSubnet1SubnetEF479E8E\"},{\"Ref\":\"moodlevpcPrivateSubnet2Subnet9E0A2679\"}],\"Tags\":[{\"Key\":\"use\",\"Value\":\"terraformer\"}]},\"Type\":\"AWS::ElastiCache::SubnetGroup\"}},\"Rules\":{\"CheckBootstrapVersion\":{\"Assertions\":[{\"Assert\":{\"Fn::Not\":[{\"Fn::Contains\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],{\"Ref\":\"BootstrapVersion\"}]}]},\"AssertDescription\":\"CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI.\"}]}}}"
  timeout_in_minutes = "0"
}
